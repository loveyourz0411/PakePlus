import{a4 as q,d as H,f as B,g as D,i as y,x as j,B as J,a5 as K,k as S,a6 as Q,r as z,o as X,a as h,z as F,bw as Y,n as r,c as n,y as ee,U as te,G as M,m as L,b as ae,F as ne,A as oe,v as re}from"./index-Dju9e0Mk.js";import{i as ie}from"./index-CSF_gV1R.js";import{u as le}from"./useObserverMsg-CMQp4RXz.js";import{_ as se}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./useObserverMsg-mppqzyYd.js";import"./system-BzlGO5Bl.js";import"./categorizeParameters-C40L_2hr.js";const de=H({name:"IconDoubleDown",props:{size:{type:[Number,String]},strokeWidth:{type:Number,default:4},strokeLinecap:{type:String,default:"butt",validator:o=>["butt","round","square"].includes(o)},strokeLinejoin:{type:String,default:"miter",validator:o=>["arcs","bevel","miter","miter-clip","round"].includes(o)},rotate:Number,spin:Boolean},emits:{click:o=>!0},setup(o,{emit:u}){const m=K("icon"),w=S(()=>[m,`${m}-double-down`,{[`${m}-spin`]:o.spin}]),f=S(()=>{const p={};return o.size&&(p.fontSize=Q(o.size)?`${o.size}px`:o.size),o.rotate&&(p.transform=`rotate(${o.rotate}deg)`),p});return{cls:w,innerStyle:f,onClick:p=>{u("click",p)}}}}),ce=["stroke-width","stroke-linecap","stroke-linejoin"];function ue(o,u,m,w,f,C){return D(),B("svg",{viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",stroke:"currentColor",class:J(o.cls),style:j(o.innerStyle),"stroke-width":o.strokeWidth,"stroke-linecap":o.strokeLinecap,"stroke-linejoin":o.strokeLinejoin,onClick:u[0]||(u[0]=(...p)=>o.onClick&&o.onClick(...p))},u[1]||(u[1]=[y("path",{d:"m9.9 11.142 14.143 14.142 14.142-14.142M9.9 22.456l14.143 14.142 14.142-14.142"},null,-1)]),14,ce)}var A=q(de,[["render",ue]]);const me=Object.assign(A,{install:(o,u)=>{var m;const w=(m=u==null?void 0:u.iconPrefix)!=null?m:"";o.component(w+A.name,A)}}),fe={__name:"GLineChart",props:{gridItem:Object},setup(o){const u=z(),m=z(!1);function w(){m.value=!m.value}let f=null;function C(e,a,b){e.markLine||(e.markLine={data:[]});const t={type:a,name:{average:"平均线",max:"上限",min:"下限"}[a],label:{show:!0,formatter({name:l,value:s}){return`${l}:${s.toFixed(2)}`}}};if(b){const l=e.markLine.data.findIndex(s=>s.type===a);l>-1?e.markLine.data[l]=t:e.markLine.data.push(t)}else e.markLine.data=e.markLine.data.filter(l=>l.type!==a)}function p(e,a,b){e.markPoint||(e.markPoint={data:[]});const i={average:{text:"平均值",color:"#409EFF"},max:{text:"最大值",color:"#F56C6C"},min:{text:"最小值",color:"#67C23A"}},t={name:i[a].text,type:a,itemStyle:{color:i[a].color},label:{show:!0,position:"top",formatter({name:l,value:s}){return`${l}:${s.toFixed(2)}`}}};if(b){const l=e.markPoint.data.findIndex(s=>s.type===a);l>-1?e.markPoint.data[l]=t:e.markPoint.data.push(t)}else e.markPoint.data=e.markPoint.data.filter(l=>l.type!==a)}function g(e,a,b){const i=f.series.findIndex(l=>l.id===b.GUID);if(i<0)return console.error("serie 查找失败");const t=f.series[i];switch(a){case"lineColor":t.itemStyle?t.itemStyle.color=e:t.itemStyle={color:e},k([{id:t.id,itemStyle:{color:e}}]);break;case"showMaxLine":C(t,"max",e),k([{id:t.id,markLine:{data:t.markLine.data}}]);break;case"showMinLine":C(t,"max",e),k([{id:t.id,markLine:{data:t.markLine.data}}]);break;case"showAverageLine":C(t,"average",e),k([{id:t.id,markLine:{data:t.markLine.data}}]);break;case"showAverageData":p(t,"average",e),k([{id:t.id,markPoint:{data:t.markPoint.data}}]);break;case"showMaxData":p(t,"max",e),k([{id:t.id,markPoint:{data:t.markPoint.data}}]);break;case"showMinData":p(t,"min",e),k([{id:t.id,markPoint:{data:t.markPoint.data}}]);break;case"showArea":k([{id:t.id,areaStyle:e?{}:void 0}]);break;case"showStep":k([{id:t.id,step:e?"middle":!1}]);break}}function k(e){x.setOption({series:e},{silent:!0})}let x=null;const P=S(()=>{const e=N.gridItem.data.dataForm.parameter;return e?Array.isArray(e)?e:[e]:[]}),$=new Map;function O(){const e=u.value;if(x=ie(e),!P.value.length)return;const a=P.value.map(i=>{const t=i.GUID;return $.set(i.parentNames.concat(i.label).join("-"),t),{id:t,sampling:"lttb",slient:!0,name:i.DisplayName||i.ParamName,type:"line",symbol:"circle",data:[]}});f={tooltip:{confine:!0,trigger:"axis",axisPointer:{type:"cross",axis:"auto",snap:!0}},legend:{show:!0},toolbox:{feature:{dataZoom:{yAxisIndex:"none",title:"区域缩放"},restore:{title:"还原"},saveAsImage:{title:"保存图片"}}},xAxis:{type:"category",boundaryGap:!1,silent:!0},yAxis:{type:"value",boundaryGap:!1,silent:!0,max:i=>(i.max*1.2).toFixed(1)},dataZoom:[{type:"slider",start:0,end:100},{start:0,end:100}],series:a},x.setOption(f),new ResizeObserver(x==null?void 0:x.resize.bind(x)).observe(e)}const N=o,{time:I,refresh:V}=le(N.gridItem.data.dataForm.parameter,G),v=S(()=>{var e;return(e=N.gridItem.data)==null?void 0:e.attrForm});X(O);function G(e){e==null||e.forEach(a=>{const b=$.get(a.Name),i=f.series.find(t=>t.id===b);if(!i)return console.error("not find Item.Name");i.data.push([a.TimeStamp,Number(a.Engineering_Value)])}),k(f.series)}function U(){f.series.forEach(e=>{e.data=[]}),k(f.series)}return(e,a)=>{const b=h("el-input"),i=h("el-button"),t=h("NSpace"),l=h("a-color-picker"),s=h("el-form-item"),_=h("a-switch"),E=h("el-form"),R=h("el-tab-pane"),T=h("el-tabs"),W=h("el-card");return D(),F(W,{style:j({background:v.value.bgColor||"#fff",borderRadius:"10px"}),shadow:"hover"},Y({default:r(()=>[y("div",{ref_key:"echartBoxRef",ref:u,class:"echartBox"},null,512)]),_:2},[v.value.hiddenTitle?void 0:{name:"header",fn:r(()=>[n(t,{align:"center",justify:"space-between"},{default:r(()=>[y("b",null,ee(v.value.title||"折线图"),1),n(t,null,{default:r(()=>[n(b,{modelValue:M(I),"onUpdate:modelValue":a[0]||(a[0]=c=>te(I)?I.value=c:null),placeholder:"请填写采样频率"},{append:r(()=>a[1]||(a[1]=[L("毫秒")])),_:1},8,["modelValue"]),n(i,{type:"primary",onClick:M(V)},{default:r(()=>a[2]||(a[2]=[L("刷新采样频率")])),_:1},8,["onClick"])]),_:1})]),_:1})]),key:"0"},v.value.hiddenFooter?void 0:{name:"footer",fn:r(()=>[n(t,{justify:"space-between"},{default:r(()=>[y("div",null,[n(i,{link:"",type:"primary",onClick:w},{default:r(()=>[n(M(me)),a[3]||(a[3]=L(" 更多配置 "))]),_:1})]),y("div",null,[n(i,{onClick:U},{default:r(()=>a[4]||(a[4]=[L("清空图表数据")])),_:1})])]),_:1}),ae(n(T,null,{default:r(()=>[(D(!0),B(ne,null,oe(P.value,(c,Z)=>(D(),F(R,{key:Z,label:c.DisplayName||c.ParamName},{default:r(()=>[n(E,{inline:!0,style:{margin:"15px 0"}},{default:r(()=>[n(s,{label:"折线颜色"},{default:r(()=>[n(l,{showText:"",onChange:d=>g(d,"lineColor",c)},null,8,["onChange"])]),_:2},1024),n(s,{label:"是否显示上限"},{default:r(()=>[n(_,{onChange:d=>g(d,"showMaxLine",c)},null,8,["onChange"])]),_:2},1024),n(s,{label:"是否显示下限"},{default:r(()=>[n(_,{onChange:d=>g(d,"showMinLine",c)},null,8,["onChange"])]),_:2},1024),n(s,{label:"是否显示平均线"},{default:r(()=>[n(_,{onChange:d=>g(d,"showAverageLine",c)},null,8,["onChange"])]),_:2},1024),n(s,{label:"是否显示平均值"},{default:r(()=>[n(_,{onChange:d=>g(d,"showAverageData",c)},null,8,["onChange"])]),_:2},1024),n(s,{label:"是否显示最大值"},{default:r(()=>[n(_,{onChange:d=>g(d,"showMaxData",c)},null,8,["onChange"])]),_:2},1024),n(s,{label:"是否显示最小值"},{default:r(()=>[n(_,{onChange:d=>g(d,"showMinData",c)},null,8,["onChange"])]),_:2},1024),n(s,{label:"是否显示区域填充"},{default:r(()=>[n(_,{onChange:d=>g(d,"showArea",c)},null,8,["onChange"])]),_:2},1024),n(s,{label:"是否显示阶梯图"},{default:r(()=>[n(_,{onChange:d=>g(d,"showStep",c)},null,8,["onChange"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["label"]))),128))]),_:1},512),[[re,m.value]])]),key:"1"}]),1032,["style"])}}},we=se(fe,[["__scopeId","data-v-4289c07f"]]);export{we as default};
