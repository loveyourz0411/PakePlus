import{s as ge,r as D,k as j,l as Ae,f as m,c as l,p as A,n as u,G as n,U as ve,i,m as g,b as B,y as T,v as I,a as s,K as fe,q as be,g as c,F,A as z,x as ye,z as b,N as _,V as ke,I as we,D as Ce}from"./index-Dju9e0Mk.js";import{_ as Se}from"./data-watch-select-b_cAMGCY.js";import{m as Te}from"./msgTree-DXiq6zYb.js";import{p as _e,g as Ee,a as Ve}from"./index-DsTk74qP.js";import{u as M}from"./util-CASLgOZv.js";import he from"./tabData-W8VUJ0XZ.js";import{u as xe,a as Be}from"./useValue-uJ0ITHZ1.js";import{u as Ie}from"./useLog-6TVPl-Rz.js";import{_ as Ne}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./dataMonitor-BqNmZQKc.js";import"./http-Cr7o0t0N.js";import"./system-BzlGO5Bl.js";import"./useObserverMsg-mppqzyYd.js";import"./categorizeParameters-C40L_2hr.js";const Le="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAAAXNSR0IArs4c6QAAAj5JREFUSEvNls9rE0EUx79vtk2yET1asZeCB0G6bYoKsR78E0wtelBEsAe7VfGk4i23ongRtVsPFUT0oGjjn+BBDaikzRakINiLYj0qZpK0u09mTaRu0uzalsE9DTvffZ95b9+PIWh+SDMPsYD773F3fU7mAMoBOMDAbnVQAr4AeAdwIZExC+/P0UqUA5FAy67lmP2bAO8JIEQ/AXxuGO5l5m3BmugjQVx2nWShE3RdYD7P4tnX2iTDv0IgDwIPDPBMbqdZzOfJV0aVpvBNZj3QGHycYbBBEDdGdyWvNTVh+LpAa7x6vQFbEjCOzU8nSp1OPjheH/LhPWdwn4K606mr7fRtgb/D6M0SaImTqezCLVqO+jdqv/8S91CtWgygZIy0C28LUCVIrVT9QECfgHEwyrPwQRqevmXCp2QmtS+cSC1Ay64cZ8YTEnTfnTLH4ngW1lgTcoZ9PkuEE66Tfrp2vw1QPmLmk10Ch+em0q/DxpiZBi7IrHpfvmMWiYjDmsxEZXjVxysieuw65qko4CKA3tGe1I5wpgUwW84ycLRRhy/KjjkShgYZvlz9rsrHdcy9HYH9tvyhCjosVB9Z5yuH2MNfXpOBYfdu+k1LWG25qBrEgmNu/7+Ali31htSytSeN5rLQXvhBNupsbc0U1tq8m6NH63j646muAby2O2i9YmxkWmzoirHVoKa9yEvUVoMjgQN2Peuz9zIOWJBxpOwkipsK6dDF+uDqivcwDrCr2zhdup2Y3xQwDuhfNL8ABfGELKP+QsEAAAAASUVORK5CYII=",Ue="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAAAXNSR0IArs4c6QAAAkFJREFUSEvNlkFrE1EQx//zduNFLHoSGgoFD0IuIijEevAjmAp6UEQwSdNTEgMqImZ3IyJKiUlOTZMIInpQsPEjeFADCuJBpSAoSAqelIoXu/tGXjRSN2l2bcvDPS3vzc7vzex/Zh5B80OaeQgFnKnXI97bboJACTAOABj/fdBlEF4yuG3Eou2FTGY1KIBA4EzeTkgp5xjY03NG+E5MXfXKxFEwtveWid4LovMLFbs9Crou0LZt0f3K16XkCwA8gO4Ik1rRMXRs25bKac9mBXHpchLgMwAMIehmdCdd6tv44esC03nrRg9G9DFiGMfmy8VXo04+WyjtX/W8R2CeVNBGxbk4zH4oUKXRk3JRwQjb4s3q5c9B/0btp3LXdjN+dBTUEGJ6WHoHgEog8k33HQOTEdM8GBSZ/yC9SF33BRF9ELHxmF9IA8BkrngcjAcA3W7VnGSYyPw2yazVAvgsCCda1dLDtfsDwFTOusfMJ4UpDjfK9jO/M2am2XNX42p9/taVDhGx3yZdsKekK58S0f1m1Tk1Gpi1lpTcJ3aJMb/SFCydsxYZOPqrQvC4UXWm/VCl3k9f5Ioqn2bN2RsE/AZg2W+oPsrkS4dc6f4VtSnMqXql+NwfZSprLakG0aw5O/47oOaU6haN9rLQXvhKUVpbW1/CWpv3n9Gjczz1I9U2gNd2B61XjI1Miw1dMbYa1PcXeInaanAgMFWw4uzhSRgwGTjSLDudTaU0Uyjt8zz3bhigYZin6+Xi600Bw4D+xeYniKqLLIk/5JMAAAAASUVORK5CYII=",De={class:"spin-content h100"},je={class:"main-content"},Fe={class:"add-btns"},ze=["onClick"],Me={key:0,style:{width:"14px",height:"14px"},src:Le,alt:""},Oe={key:1,style:{width:"14px",height:"14px"},src:Ue,alt:""},Re={style:{margin:"0 5px"}},Ge={key:2,class:"pub-loading"},Ke={class:"operate-tag"},Pe={key:0,class:"spin-mask"};function Xe(y){return typeof y=="function"||Object.prototype.toString.call(y)==="[object Object]"&&!Ce(y)}const He={__name:"index",setup(y){const O=fe(),{appContext:R}=ge(),{$hasbtn:G,$modal:K}=R.config.globalProperties,r=D({}),{AeTableRef:N,startSendValues:P,stopSendValues:E,setQueryValues:L}=xe(r),{tabs:U,msgTreeRef:k,msgCheckedKeys:X,splitSize:V,noSaveAs:w,fullLoading:v,importWatch:H,saveTabAs:W,removeTab:Q,addToWatch:Y,onTabChange:Z,cancelToTable:q}=Be(r,L,E),{logLoading:J,startLog:$,stopLog:ee}=Ie(N),f=D({selectName:""}),te=j(()=>[{clickHandle:se,imgSrc:"images/d-saveFile.png",title:"调用仿真面板"},{clickHandle:ie,imgSrc:"images/d-dataToggle.png",title:"数据切换"},{clickHandle:()=>O.push({name:"chartArea"}),imgSrc:"images/d-watchPic.png",title:"图形监控"},{clickHandle:H,imgSrc:"images/d-openFile.png",title:"打开Watch"},{clickHandle:W,imgSrc:"images/d-saveFile.png",title:"保存Watch",extraClassNames:w.value&&"disable"},G("dataPanel-startlog")?{clickHandle:$,imgSrc:"images/d-startLog.png",loading:J.value,title:"开始Log"}:null,{clickHandle:ee,imgSrc:"images/d-stopLog.png",title:"停止Log"}]),oe=j(()=>{const o=[{label:"新建子窗口",value:0}];for(const e of U.value)e.isMain||o.push({label:e.name,value:e});return o});Ae(()=>be(()=>{var o,e;(o=k.value)==null||o.getList(),(e=k.value)==null||e.checkAll()}));function ne(o){var e;if(!o.win||(e=o.win)!=null&&e.closed){const a=ae(o.name,o.tableData);Object.defineProperty(o,"win",{configurable:!0,value:a})}else o.win.focus()}function ae(o,e){const a=window.open(`${location.origin}/watchTable`);return window.onCreateSubWinLoaded=()=>{a.postMessage({type:"update",title:o,data:M.clone(e)})},a}function le(o){X.value=o}async function se(){const o=await window.getDBItem("controlList")||[];K.open({title:"选择仿真面板",width:600,okText:"去往该仿真面板",cancelText:"取消",titleAlign:"start",draggable:!0,content:()=>{let e;return l(s("a-form"),{model:f.value,"label-align":"left","auto-label-width":!0},{default:()=>[l(s("a-form-item"),{label:"选择仿真面板"},{default:()=>[l(s("a-select"),{modelValue:f.value.selectName,"onUpdate:modelValue":a=>f.value.selectName=a},Xe(e=o.map(a=>l(s("a-option"),{value:a.id,label:a.title},null)))?e:{default:()=>[e]})]})]})},onOk:()=>{const e=o.find(a=>a.id===f.value.selectName);f.value={selectName:""},window.open(`${location.origin}/preview?id=${e==null?void 0:e.id}`)}})}function ie(){k.value.toggleModel()}function re(o){const{protocolType:e,level:a,label:h}=o;let d=[];if(e)d=(_e.find(x=>x.label===e)||{})[a===1?"tables":"childrenTables"]||[];else if(["Publish","Subscribe"].includes(h))d=Ve;else return Object.assign(r.value,{tableData:[],tableColumns:d});const C=M.clone(Ee(o));L(d.some(S=>S.key==="Value")?C:[]),Object.assign(r.value,{tableData:C,tableColumns:d})}return(o,e)=>{const a=s("BtnGroup"),h=s("a-input"),d=s("a-option"),C=s("a-select"),S=s("Icon"),x=s("icon"),ce=s("a-doption"),ue=s("a-dropdown"),de=s("a-split"),pe=s("NProgress"),me=s("NButton");return c(),m("div",De,[l(de,{size:n(V),"onUpdate:size":e[4]||(e[4]=t=>ve(V)?V.value=t:null),disabled:!n(w),class:"h100",max:.8},{first:u(()=>[l(Te,{ref_key:"msgTreeRef",ref:k,onUpdateCheckedKeys:le,onUpdateSelectedKeys:re},null,512)]),second:u(()=>[i("div",je,[e[10]||(e[10]=i("div",{class:"navHeader"},[i("div",{class:"img-box"},[i("img",{src:Se})]),i("span",null,"数据监控")],-1)),l(a,{data:te.value},null,8,["data"]),i("div",Fe,[(c(!0),m(F,null,z(n(U),t=>(c(),m("span",{key:t.name,class:"operate-tag",style:ye({color:r.value.name===t.name?"#2C68F6":"#636E7E"}),onClick:p=>n(Z)(t)},[r.value.name===t.name?(c(),m("img",Me)):(c(),m("img",Oe)),i("span",Re,T(t.name),1),t.pubValueTimer?(c(),m("div",Ge,e[5]||(e[5]=[i("div",{class:"coin"},null,-1)]))):A("",!0),!t.isMain&&t.sendType===1?(c(),b(h,{key:3,modelValue:t.timer,"onUpdate:modelValue":p=>t.timer=p,disabled:r.value.name!==t.name||!!t.pubValueTimer,size:"mini",style:{width:"100px","margin-left":"10px"},"default-value":"1000",onClick:e[0]||(e[0]=_(()=>{},["stop"]))},{suffix:u(()=>e[6]||(e[6]=[g(" ms ")])),_:2},1032,["modelValue","onUpdate:modelValue","disabled"])):A("",!0),t.isMain?A("",!0):(c(),b(C,{key:4,modelValue:t.sendType,"onUpdate:modelValue":p=>t.sendType=p,size:"mini",style:{width:"100px"},placeholder:"请选择",type:"button",disabled:r.value.name!==t.name||!!t.pubValueTimer,"default-value":0,onClick:e[1]||(e[1]=_(()=>{},["stop"]))},{default:u(()=>[l(d,{value:0},{default:u(()=>e[7]||(e[7]=[g("单次发送")])),_:1}),l(d,{value:1},{default:u(()=>e[8]||(e[8]=[g("连续发送")])),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue","disabled"])),t.isMain?A("",!0):(c(),b(n(ke),{key:5,style:{color:"#333","margin-right":"10px"},size:"18",onClick:_(p=>ne(t),["stop"])},null,8,["onClick"])),t.isMain?A("",!0):(c(),b(S,{key:6,name:"icon-close1",size:"15",color:r.value.name===t.name?"#2C68F6":"#636E7E",onClick:_(p=>n(Q)(t),["stop"])},null,8,["color","onClick"]))],12,ze))),128)),l(ue,{trigger:"hover",onSelect:n(Y)},{content:u(()=>[(c(!0),m(F,null,z(oe.value,(t,p)=>(c(),b(ce,{key:p,value:t.value},{default:u(()=>[g(T(t.label),1)]),_:2},1032,["value"]))),128))]),default:u(()=>[i("span",Ke,[l(x,{name:"icon-xinzeng",size:"14",color:"#636E7E"}),e[9]||(e[9]=i("span",{style:{margin:"0 5px"}},"添加子窗口",-1))])]),_:1},8,["onSelect"]),B(i("span",{class:"operate-tag",onClick:e[2]||(e[2]=t=>n(P)(r.value))}," 发送数据 ",512),[[I,!n(w)&&!r.value.pubValueTimer]]),B(i("span",{class:"operate-tag",onClick:e[3]||(e[3]=(...t)=>n(E)&&n(E)(...t))}," 停止发送 ",512),[[I,!n(w)&&r.value.pubValueTimer]])]),l(he,{ref_key:"AeTableRef",ref:N,loggingSelection:!0,currentTag:r.value},null,8,["currentTag"])])]),_:1},8,["size","disabled"]),n(v).value?(c(),m("div",Pe,[i("div",null,[i("div",null,[l(n(we),{size:"40"})]),g(" "+T(n(v).description)+" ",1),B(l(pe,{style:{width:"200px"},type:"line",percentage:n(v).percentage,processing:""},{default:u(()=>[g(T(n(v).progressText),1)]),_:1},8,["percentage"]),[[I,n(v).showProgress]]),l(me,{type:"warning",onClick:n(q)},{default:u(()=>e[11]||(e[11]=[g("取 消")])),_:1},8,["onClick"])])])):A("",!0)])}}},it=Ne(He,[["__scopeId","data-v-ca13fc74"]]);export{it as default};
