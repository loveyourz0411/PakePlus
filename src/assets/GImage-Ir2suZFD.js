import{u as k}from"./useObserverMsg-CMQp4RXz.js";import{p as u}from"./useFile-Bgo6_xp2.js";import{c as D}from"./categorizeParameters-C40L_2hr.js";import{s as E}from"./system-BzlGO5Bl.js";import{u as T}from"./util-CASLgOZv.js";import{_ as C}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{k as s,r as M,a_ as G,a as N,z as j,g as w,bw as z,n as g,i as p,y as B,x as S}from"./index-Dju9e0Mk.js";import"./useObserverMsg-mppqzyYd.js";const O=["src"],P={__name:"GImage",props:{gridItem:Object},setup(d){const f=d,o=s(()=>f.gridItem.data),v=s(()=>o.value.triggerForm),_=s(()=>o.value.eventForm),l=s(()=>o.value.dataForm),m=M(0),b=s(()=>{var e;return(e=l.value.images[m.value])==null?void 0:e.src}),V=G("environment");function h(){if(V!=="PREVIEW")return;const e=_.value.tableData.find(t=>t.img===m.value),a=u.eventTable[e.eventType];E({once:!0,messageList:D([{...a.parameter,_Value:T.parseValue(a.msgValue)}])})}const c=new Map;function I(){var n;const e=[];(n=v.value.tableData)==null||n.forEach(r=>{if(r.img===void 0||r.triggerType===void 0)return;const i=u.triggerTable[r.triggerType];e.some(x=>x.GUID===i.parameter.GUID)||e.push(i.parameter),y(r,i)});const{time:a,refresh:t}=k(e,F);a.value=300,t()}function y(e,a){const t=a.parameter,n=t.parentNames.concat([t.label]).join("-"),r=c.get(n);if(r)return r.push({img:e.img,msgValue:a.msgValue});c.set(n,[{img:e.img,msgValue:a.msgValue}])}function F(e){let a=!1;e==null||e.forEach(t=>{const n=c.get(t.Name);n==null||n.forEach(r=>{t.Engineering_Value===r.msgValue&&(m.value=r.img,a=!0)})}),a||(m.value=l.value.targetIndex)}return I(),(e,a)=>{const t=N("el-card");return w(),j(t,{style:S({background:o.value.attrForm.bgColor||"transparent",borderRadius:"10px"})},z({default:g(()=>[p("img",{src:b.value,alt:"",onClick:h},null,8,O)]),_:2},[o.value.attrForm.hiddenTitle?void 0:{name:"header",fn:g(()=>[p("b",null,B(o.value.attrForm.title||"图片"),1)]),key:"0"}]),1032,["style"])}}},K=C(P,[["__scopeId","data-v-b4d1d144"]]);export{K as default};
