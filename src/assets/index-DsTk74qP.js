import{u as c}from"./util-CASLgOZv.js";import{h as p,b9 as L}from"./index-Dju9e0Mk.js";import{a as T}from"./dataMonitor-BqNmZQKc.js";const C=[{label:"Hex Value",value:"hex_value"},{label:"Binary Value",value:"binary_value"},{label:"Engineering Value",value:"engineering_value"}],o=(e,l,t)=>p("div",null,[e.label,p(L,{size:"mini",defaultValue:"engineering_value",placeholder:"请选择",options:C,onChange(r){l.forEach(a=>{t[a.GUID]=r})},style:{marginLeft:"10px"}})]),D=[{label:"A429",tables:[{label:"Name",key:"label",customFilterDropdown:!0,onFilter:(e,l)=>{const t=l.label||"";return e.some(r=>t.toLowerCase().includes(r.toLowerCase()))}},{label:"Bit Rate",key:"bitrate",customFilterDropdown:!0,onFilter:(e,l)=>{const t=l.bitrate||"";return e.some(r=>t.toLowerCase().includes(r.toLowerCase()))}},{label:"# Of Publish",key:""},{label:"# Of Subscribers",key:""}],childrenTables:[{label:"Word Name",key:"WordName",minWidth:150,customFilterDropdown:!0,onFilter:(e,l)=>{const t=l.WordName||"";return e.some(r=>t.toLowerCase().includes(r.toLowerCase()))}},{label:"Parameters Name",key:"ParamName",minWidth:150,customFilterDropdown:!0,onFilter:(e,l)=>{const t=l.ParamName||"";return e.some(r=>t.toLowerCase().includes(r.toLowerCase()))}},{label:"Label",key:"Label",minWidth:100,customFilterDropdown:!0,onFilter:(e,l)=>{const t=l.Label||"";return e.some(r=>t.toLowerCase().includes(r.toLowerCase()))}},{label:"Bit Offset",key:"BitOffset",minWidth:120},{label:"Value",nameFilter:!0,key:"Value",minWidth:80},{label:"Display Type",minWidth:250,header:o},{label:"Units",nameFilter:!0,key:"Units",minWidth:80},{label:"Time Of Last Refresh",nameFilter:!0,key:"TimeRefresh",minWidth:150},{label:"Hardware Time",nameFilter:!0,key:"HardwareTime",minWidth:120},{label:"Error Code",key:"ErrorCode",minWidth:120}]},{label:"Analog",tables:[{label:"Name",key:"label",minWidth:150,customFilterDropdown:!0,onFilter:(e,l)=>{const t=l.label||"";return e.some(r=>t.toLowerCase().includes(r.toLowerCase()))}},{label:"Value",key:"Value",minWidth:80},{label:"Display Type",minWidth:250,header:o},{label:"Time Of Last Refresh",key:"TimeRefresh",minWidth:150},{label:"# Of Publish",key:"",minWidth:150},{label:"# Of Subscribers",key:"",minWidth:150}],childrenTables:[{label:"Name",key:"ParamName",minWidth:150,customFilterDropdown:!0,onFilter:(e,l)=>{const t=l.ParamName||"";return e.some(r=>t.toLowerCase().includes(r.toLowerCase()))}},{label:"Value",key:"Value",minWidth:80},{label:"Display Type",minWidth:250,header:o},{label:"Units",key:"Units",minWidth:80},{label:"Time Of Last Refresh",minWidth:150,key:"TimeRefresh"},{label:"# Of Publish",minWidth:150,key:""},{label:"# Of Subscribers",minWidth:150,key:""}]},{label:"Discrete",tables:[{label:"Name",key:"label",minWidth:150,customFilterDropdown:!0,onFilter:(e,l)=>{const t=l.label||"";return e.some(r=>t.toLowerCase().includes(r.toLowerCase()))}},{label:"Value",key:"Value",minWidth:80},{label:"Display Type",minWidth:250,header:o},{label:"Time Of Last Refresh",key:"TimeRefresh",minWidth:150},{label:"# Of Publish",key:"",minWidth:150},{label:"# Of Subscribers",key:"",minWidth:150}],childrenTables:[{label:"Name",key:"ParamName",minWidth:150,customFilterDropdown:!0,onFilter:(e,l)=>{const t=l.ParamName||"";return e.some(r=>t.toLowerCase().includes(r.toLowerCase()))}},{label:"Value",key:"Value",minWidth:80},{label:"Display Type",minWidth:250,header:o},{label:"Units",key:"Units",minWidth:80},{label:"Time Of Last Refresh",minWidth:150,key:"TimeRefresh"},{label:"# Of Publish",minWidth:150,key:""},{label:"# Of Subscribers",minWidth:150,key:""}]},{label:"Serial",tables:[{label:"Name",key:"label",customFilterDropdown:!0,onFilter:(e,l)=>{const t=l.label||"";return e.some(r=>t.toLowerCase().includes(r.toLowerCase()))}},{label:"# Of Publish",key:""},{label:"# Of Subscribers",key:""}],childrenTables:[{label:"Message Name",key:"parentName",minWidth:150,customFilterDropdown:!0,onFilter:(e,l)=>{const t=l.parentName||"";return e.some(r=>t.toLowerCase().includes(r.toLowerCase()))}},{label:"Parameters Name",key:"ParamName",minWidth:150,customFilterDropdown:!0,onFilter:(e,l)=>{const t=l.ParamName||"";return e.some(r=>t.toLowerCase().includes(r.toLowerCase()))}},{label:"Bit Offset",key:"BitOffset"},{label:"Value",nameFilter:!0,key:"Value"},{label:"Display Type",minWidth:250,header:o},{label:"Units",nameFilter:!0,key:"Units"},{label:"Time Of Last Refresh",nameFilter:!0,key:"TimeRefresh"}]},{label:"TCP_UDP",tables:[{label:"Name",key:"label",customFilterDropdown:!0,onFilter:(e,l)=>{const t=l.label||"";return e.some(r=>t.toLowerCase().includes(r.toLowerCase()))}},{label:"# Of Publish",key:""},{label:"# Of Subscribers",key:""}],childrenTables:[{label:"Message Name",key:"parentName",minWidth:150,customFilterDropdown:!0,onFilter:(e,l)=>{const t=l.parentName||"";return e.some(r=>t.toLowerCase().includes(r.toLowerCase()))}},{label:"Parameters Name",key:"ParamName",minWidth:150,customFilterDropdown:!0,onFilter:(e,l)=>{const t=l.ParamName||"";return e.some(r=>t.toLowerCase().includes(r.toLowerCase()))}},{label:"Bit Offset",key:"BitOffset"},{label:"Value",nameFilter:!0,key:"Value"},{label:"Display Type",minWidth:250,header:o},{label:"Units",nameFilter:!0,key:"Units"},{label:"Time Of Last Refresh",nameFilter:!0,key:"TimeRefresh"}]},{label:"UserProtocol",tables:[{label:"Name",key:"label",customFilterDropdown:!0,onFilter:(e,l)=>{const t=l.label||"";return e.some(r=>t.toLowerCase().includes(r.toLowerCase()))}},{label:"# Of Publish",key:""},{label:"# Of Subscribers",key:""}],childrenTables:[{label:"Message Name",key:"parentName",minWidth:150,customFilterDropdown:!0,onFilter:(e,l)=>{const t=l.parentName||"";return e.some(r=>t.toLowerCase().includes(r.toLowerCase()))}},{label:"Parameters Name",key:"ParamName",minWidth:150,customFilterDropdown:!0,onFilter:(e,l)=>{const t=l.ParamName||"";return e.some(r=>t.toLowerCase().includes(r.toLowerCase()))}},{label:"Bit Offset",key:"BitOffset"},{label:"Value",nameFilter:!0,key:"Value"},{label:"Display Type",minWidth:250,header:o},{label:"Units",nameFilter:!0,key:"Units"},{label:"Time Of Last Refresh",nameFilter:!0,key:"TimeRefresh"}]},{label:"A664",tables:[{label:"Name",nameFilter:!0,key:"label",minWidth:150},{label:"# Of Publish",key:""},{label:"# Of Subscribers",key:""}],childrenTables:[{label:"Data Set Name / Block Name",nameFilter:!0,key:"DBName",minWidth:250},{label:"Word Name",nameFilter:!0,key:"WordName",minWidth:150},{label:"Parameter Name",nameFilter:!0,key:"ParamName",minWidth:150},{label:"Value",nameFilter:!0,key:"Value"},{label:"Display Type",minWidth:250,header:o},{label:"Units",nameFilter:!0,key:"Units"},{label:"Time Of Last Refresh",nameFilter:!0,key:"TimeRefresh"}]},{label:"A825",tables:[{label:"Name",key:"label",nameFilter:!0,minWidth:150},{label:"# Of Publish",key:""},{label:"# Of Subscribers",key:""}],childrenTables:[{label:"Bus Name",key:"BusName",nameFilter:!0,minWidth:150},{label:"Message Name",key:"MsgName",nameFilter:!0,minWidth:180},{label:"Word Name",key:"WordName",nameFilter:!0,minWidth:150},{label:"Parameter Name",key:"ParamName",nameFilter:!0,minWidth:200},{label:"Value",key:"Value",nameFilter:!0,minWidth:100},{label:"Time Of Last Refresh",nameFilter:!0,key:"TimeRefresh"},{label:"Hardware Time",nameFilter:!0,key:"HardwareTime"},{label:"Error Code",key:"ErrorCode"}]}];D.forEach(e=>{e.tables.forEach(k),e.childrenTables.forEach(k)});function k(e){Object.assign(e,{drag:!0,ellipsis:!0,resizable:!0,align:"center"})}function h(e={},l={}){var r,a;if(e.level===1)return e.children;const t=[];if(e.ParamName){const[n,i]=e.parentNames.slice(1,3);t.push({...e,...l,WordName:i,BusName:n})}else if(e.WordName){const{SDIType:n,SSMType:i}=e;n==="Dynamic"&&t.push({WordName:e.label,BusName:e.parentName,Label:e.Label,Units:e.Units,label:"SDI",GUID:c.randomString(),ParamName:"SDI",protocolType:"A429",BitOffset:9,parentNames:["A429",e.parentName,e.label],level:4}),(r=e.children)==null||r.forEach(s=>Array.prototype.push.apply(t,h(s,{Label:e.Label}))),t.sort((s,b)=>s.BitOffset-b.BitOffset),i&&i!=="None"&&t.push({WordName:e.label,BusName:e.parentName,Label:e.Label,Units:e.Units,label:"SSM",GUID:c.randomString(),protocolType:"A429",parentNames:["A429",e.parentName,e.label],ParamName:"A429SSM",BitOffset:30,level:4})}else(a=e.children)==null||a.forEach(n=>Array.prototype.push.apply(t,h(n)));return t}function N(e={}){if(e.level===1)return e.children;const l=[],{children:t=[]}=e;return e.ParamName?l.push({...e,DBName:e.DataSetName||e.BlockName}):t.forEach(r=>Array.prototype.push.apply(l,N(r))),l}function W(e={}){if(e.level===1)return e.children;const l=[],{children:t=[]}=e;if(e.ParamName){const r={...e};l.push(r)}else t.forEach(r=>Array.prototype.push.apply(l,W(r))),l.sort((r,a)=>r.BitOffset-a.BitOffset);return l}function O(e){const{protocolType:l,children:t=[],level:r}=e;let a=null;return l==="A429"?a=h(e):l==="A664"?a=N(e):l==="A825"?a=W(e):["Analog","Discrete"].includes(l)&&r===2?a=[e]:["Serial","UserProtocol","TCP_UDP"].includes(l)&&r===3&&(a=[e]),a||t}const V=[{label:"Message Name",key:"label",minWidth:150,customFilterDropdown:!0,onFilter:(e,l)=>{const t=l.label||"";return e.some(r=>t.toLowerCase().includes(r.toLowerCase()))}}];function P(e,l){const t=O(e).filter(r=>!l.some(a=>a.GUID===r.GUID));l.push(...t)}async function x(e=[],l=[],t,r,a){const n=c.clone(e),i=c.clone(l);try{for(let s=0,b=n.length;s<b;s++){if(r.isCancel)return a(),Promise.reject(new Error("cancel"));const m=n[s];m&&![0,1].includes(m.level)&&(m.level===2&&!m.loadend&&await g(m),P(m,i)),t(s)}return i}catch(s){return Promise.reject(s)}}function F(e=[]){return e.forEach(l=>{var t;(t=l.children)!=null&&t.length&&F(l.children)}),e.sort((l,t)=>(l.label||"").toLocaleUpperCase().localeCompare((t.label||"").toLocaleUpperCase()))}function g(e){return!e||e.loadend?Promise.resolve(e):T(e.label,e.protocolType).then(l=>{if(!(l!=null&&l.name))return e.isLeaf=!0,e;const t=w(l,1,e.protocolType,[e.protocolType]);return Object.assign(e,t,{uuid:e.uuid,loadend:!0,children:F(t.children)}),e})}function w(e,l,t,r,a={}){var d,f;const n=r[r.length-1],i={children:[],level:l+1,protocolType:t,label:e.name,parentName:n,parentNames:r},s={};let b=!1;(d=e.attributes)==null||d.forEach(({name:u,value:y})=>{u==="ParamName"&&(b=!0),u.toLocaleUpperCase().includes("NAME")&&u!=="DisplayName"&&(s[u]=y),isNaN(Number(u))&&(i[u]=y)}),i.uuid=c.randomString();const m={...a,...s};return b&&Object.assign(i,a),(f=e.children_info)!=null&&f.length?i.children=e.children_info.map(u=>w(u,l+1,t,[...r,i.label],m)):(delete i.children,i.isLeaf=!0),i}export{V as a,C as b,x as c,o as d,O as g,g as l,D as p,F as t};
