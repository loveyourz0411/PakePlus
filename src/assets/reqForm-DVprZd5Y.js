import{_ as C}from"./auto-test-select-DqLsCXzn.js";import{s as F,r as i,a8 as j,f as S,i as s,m,y as U,c as o,n as l,a as u,K as B,g as D}from"./index-Dju9e0Mk.js";import{P as O,A as P}from"./requirement-DsTjIJZq.js";import{r as q}from"./defaultParam-mXCUOp30.js";import{_ as A}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./http-Cr7o0t0N.js";const $={class:"main-content"},w={class:"navHeader"},z={class:"child-text"},E={class:"form-box"},H={class:"footer"},J={__name:"reqForm",setup(K){const{appContext:b}=F(),{$message:p}=b.config.globalProperties,c=B(),g=j(),t=i(q()),I={reqName:{type:"string",required:!0,message:"请填写需求名称"},reqId:{type:"string",required:!0,message:"请填写需求号"}},V=i("create"),f=i(),{parentId:_,id:y,projectId:k}=g.query;if(t.value=q({projectId:+k,parentId:_?+_:0}),y){const a=JSON.parse(sessionStorage.getItem("requirement"));Object.assign(t.value,{id:a.ID,reqName:a.Req_Name,reqId:a.Req_ID,version:a.version,content:a.content,parentId:a.parentId})}function N(){c.back()}function x(){f.value.validate(a=>{if(a)return;const e={...t.value};Object.assign(e,{type:e.content?0:1}),(e.id?O:P)(e).then(r=>{if(r.code!==200)return p.error(r.errMsg||"操作失败");p.success("操作成功"),c.back()})})}return(a,e)=>{const d=u("a-input"),r=u("a-form-item"),v=u("a-button"),R=u("a-form");return D(),S("div",$,[s("div",w,[e[5]||(e[5]=s("div",{class:"img-box"},[s("img",{src:C})],-1)),s("span",null,[e[4]||(e[4]=m("自动化测试 / ")),s("span",z,U(V.value==="create"?"新增":"修改")+"需求",1)])]),s("div",E,[o(R,{ref_key:"dataFormRef",ref:f,"scroll-to-first-error":!0,rules:I,model:t.value,size:"large",layout:"vertical"},{default:l(()=>[o(r,{field:"reqName",feedback:"",label:"需求名称",tooltip:"需求名称/需求章节名称"},{default:l(()=>[o(d,{modelValue:t.value.reqName,"onUpdate:modelValue":e[0]||(e[0]=n=>t.value.reqName=n),placeholder:"请输入需求名称"},null,8,["modelValue"])]),_:1}),o(r,{field:"reqId",feedback:"",label:"需求号",tooltip:"需求号"},{default:l(()=>[o(d,{modelValue:t.value.reqId,"onUpdate:modelValue":e[1]||(e[1]=n=>t.value.reqId=n),placeholder:"请输入需求号"},null,8,["modelValue"])]),_:1}),o(r,{field:"version",label:"需求版本",tooltip:"版本号 建议纯数字"},{default:l(()=>[o(d,{modelValue:t.value.version,"onUpdate:modelValue":e[2]||(e[2]=n=>t.value.version=n),placeholder:"请输入需求版本"},null,8,["modelValue"])]),_:1}),o(r,{field:"content",label:"需求描述",tooltip:"需求章节不用填需求描述"},{default:l(()=>[o(d,{modelValue:t.value.content,"onUpdate:modelValue":e[3]||(e[3]=n=>t.value.content=n),placeholder:"请输入需求描述"},null,8,["modelValue"])]),_:1}),o(r,null,{default:l(()=>[s("div",H,[o(v,{onClick:N},{default:l(()=>e[6]||(e[6]=[m("返回")])),_:1}),o(v,{type:"primary",onClick:x},{default:l(()=>e[7]||(e[7]=[m("提交")])),_:1})])]),_:1})]),_:1},8,["model"])])])}}},X=A(J,[["__scopeId","data-v-b18c4ed1"]]);export{X as default};
