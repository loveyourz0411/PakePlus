import{_ as S}from"./auto-test-select-DqLsCXzn.js";import{s as B,r as i,b3 as E,f as z,i as u,c as a,m as c,a as n,K as P,g as w,F as A}from"./index-Dju9e0Mk.js";import{D as v,G as M}from"./project-6v6tL3Yb.js";import{_ as D}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./http-Cr7o0t0N.js";const R={class:"main-content"},G={__name:"index",setup(L){const{appContext:x}=B(),{$message:o,$modal:h}=x.config.globalProperties,p=P(),f=i([]);function _(){p.push({name:"projectForm"})}function k(e){sessionStorage.setItem("editProject",JSON.stringify(e)),p.push({name:"projectForm",query:{projectId:e.id}})}const j=[{title:"项目名称",align:"center",dataIndex:"projectName",ellipsis:!0,tooltip:!0,nameFilter:!0,minWidth:250,filterable:{filter:(e,t)=>t.projectName.includes(e),slotName:"name-filter"}},{title:"创建时间",align:"center",dataIndex:"createdTime",ellipsis:!0,tooltip:!0,minWidth:250},{title:"创建人",align:"center",ellipsis:!0,tooltip:!0,render({record:e}){return e.userInfo.userName}},{title:"版本",align:"center",dataIndex:"version",ellipsis:!0,tooltip:!0},{title:"备注",align:"center",dataIndex:"remark",ellipsis:!0,tooltip:!0},{title:"操作",align:"center",width:250,render({record:e}){return a(A,null,[a(n("a-button"),{type:"text",onclick:()=>k(e)},{default:()=>[c("修改")]}),a(n("a-popconfirm"),{content:"确定删除这个数据吗?",type:"warning",onOk:()=>I(e)},{default:()=>[a(n("a-button"),{type:"text"},{default:()=>[c("删除")]})]}),a(n("a-button"),{type:"text",onclick:()=>N(e)},{default:()=>[c("进入项目")]})])}}];function I(e){v([e.id]).then(t=>{if(t.code!==200)return o.error(t.errMsg||"删除失败");r(),o.success("删除成功")})}function N(e){var t;sessionStorage.setItem("projectInfo",JSON.stringify([{label:"项目名称",value:e.projectName},{label:"创建人",value:((t=e.userInfo)==null?void 0:t.userName)||""},{label:"创建时间",value:e.createdTime},{label:"描述",value:e.remark},{label:"版本",value:e.version}])),p.push({name:"projectInfo",query:{projectId:e.id}})}const C=[{clickHandle:_,img2Src:"images/create.png",bgColor:"#409eff",title:"新增项目"},{clickHandle:T,imgSrc:"images/delete.png",title:"批量删除"}],d=i(null);function T(){const e=d.value.vxeTabMethods.getCheckboxRecords(!0);if(!e.length)return o.warning("没有选择数据");h.open({title:"提示",content:"确定删除这些数据吗?这将不可恢复",onBeforeOk:t=>{v(e.map(l=>l.id)).then(l=>{if(l.code!==200)return o.error(l.errMsg||"操作失败");d.value.vxeTabMethods.setAllCheckboxRow(!1),t(),r(),o.success("删除成功")})}})}const b=i(0),m=i(1),g=i(10);function r(){M({pageNumber:m.value,pageSize:g.value}).then(e=>{if(console.log(e),e.code!==200)return o.error(e.errMsg||"获取项目列表失败");f.value=e.data,b.value=e.total})}return E(r),(e,t)=>{const l=n("BtnGroup"),y=n("AeTable"),F=n("a-pagination");return w(),z("div",R,[t[2]||(t[2]=u("div",{class:"navHeader"},[u("div",{class:"img-box"},[u("img",{src:S})]),u("span",null,[c("自动化测试 / "),u("span",{class:"child-text"},"项目管理")])],-1)),a(l,{data:C}),a(y,{ref_key:"vxeTableRef",ref:d,class:"table-data",hasCheckbox:"",columns:j,data:f.value,checkboxConfig:{checkMethod:({row:s})=>!s.disabled}},null,8,["data","checkboxConfig"]),a(F,{current:m.value,"onUpdate:current":t[0]||(t[0]=s=>m.value=s),"page-size":g.value,"onUpdate:pageSize":t[1]||(t[1]=s=>g.value=s),total:b.value,"show-page-size":"","show-total":"",onChange:r,onPageSizeChange:r},null,8,["current","page-size","total"])])}}},K=D(G,[["__scopeId","data-v-4d9f547d"]]);export{K as default};
