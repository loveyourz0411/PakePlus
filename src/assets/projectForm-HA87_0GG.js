import{_ as B}from"./auto-test-select-DqLsCXzn.js";import{s as R,r as f,a8 as S,f as v,i as d,m as b,y as z,c as a,n as r,a as i,K as D,g as m,F as y,A as g,z as V}from"./index-Dju9e0Mk.js";import{G}from"./user-UnMz5OIS.js";import{A as L,P as M}from"./project-6v6tL3Yb.js";import{p as h}from"./defaultParam-mXCUOp30.js";import{_ as O}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./http-Cr7o0t0N.js";const $={class:"main-content"},H={class:"navHeader"},J={class:"child-text"},K={class:"form-box"},T={class:"footer"},Q={__name:"projectForm",setup(W){const{appContext:I}=R(),{$message:k}=I.config.globalProperties,F=D(),C=S(),o=f(h()),p=f([]),c=f("create");function P(){G({getAll:!0}).then(l=>{p.value=l.data||[]})}const U={projectName:{type:"string",required:!0,message:"请填写项目名称"},m1:{type:"array",required:!0,message:"请选择超级管理员"},version:{type:"string",required:!0,message:"请填写项目版本"}};function E(){var e;const l=JSON.parse(sessionStorage.getItem("editProject"));return Object.assign(l,{m1:[],m2:[],m3:[]}),(e=l.members)==null||e.forEach(s=>{s.type===0?l.m1.push(s.userId):s.type===1?l.m2.push(s.userId):s.type===2&&l.m3.push(s.userId)}),delete l.members,l}const j=f();C.query.projectId?(o.value=E(),c.value="edit"):(o.value=h(),c.value="create"),P();function x(){F.back()}function q(){j.value.validate(l=>{if(l)return;const e={...o.value,members:[]};w(e),(c.value==="create"?L:M)(e).then(u=>{if(u.code!==200)return k.error(u.errMsg||"操作失败");k.success(u.msg||"操作成功"),x()})})}function w(l){(l.m1||[]).forEach(n=>{l.members.push({type:0,userId:n})}),(l.m2||[]).forEach(n=>{l.members.push({type:1,userId:n})}),(l.m3||[]).forEach(n=>{l.members.push({type:2,userId:n})}),delete l.m1,delete l.m2,delete l.m3}return(l,e)=>{const s=i("a-input"),u=i("a-form-item"),n=i("a-option"),_=i("a-select"),N=i("a-button"),A=i("a-form");return m(),v("div",$,[d("div",H,[e[7]||(e[7]=d("div",{class:"img-box"},[d("img",{src:B})],-1)),d("span",null,[e[6]||(e[6]=b("自动化测试 / ")),d("span",J,z(c.value==="create"?"新增":"修改")+"项目",1)])]),d("div",K,[a(A,{ref_key:"dataFormRef",ref:j,"scroll-to-first-error":!0,rules:U,model:o.value,size:"large",layout:"vertical"},{default:r(()=>[a(u,{field:"projectName",feedback:"",label:"项目名称",tooltip:"项目名称 不可重复"},{default:r(()=>[a(s,{modelValue:o.value.projectName,"onUpdate:modelValue":e[0]||(e[0]=t=>o.value.projectName=t),placeholder:"请输入项目名"},null,8,["modelValue"])]),_:1}),a(u,{field:"m1",label:"超级管理员"},{default:r(()=>[a(_,{modelValue:o.value.m1,"onUpdate:modelValue":e[1]||(e[1]=t=>o.value.m1=t),multiple:"",placeholder:"请选择超级管理员",style:{width:"100%"}},{default:r(()=>[(m(!0),v(y,null,g(p.value,t=>(m(),V(n,{key:t.id,label:t.userName,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(u,{field:"m2",label:"开发者"},{default:r(()=>[a(_,{modelValue:o.value.m2,"onUpdate:modelValue":e[2]||(e[2]=t=>o.value.m2=t),multiple:"",placeholder:"请选择开发者",style:{width:"100%"}},{default:r(()=>[(m(!0),v(y,null,g(p.value,t=>(m(),V(n,{key:t.id,label:t.userName,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(u,{field:"m3",label:"操作员"},{default:r(()=>[a(_,{modelValue:o.value.m3,"onUpdate:modelValue":e[3]||(e[3]=t=>o.value.m3=t),multiple:"",placeholder:"请选择操作员",style:{width:"100%"}},{default:r(()=>[(m(!0),v(y,null,g(p.value,t=>(m(),V(n,{key:t.id,label:t.userName,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(u,{field:"version",feedback:"",label:"版本"},{default:r(()=>[a(s,{modelValue:o.value.version,"onUpdate:modelValue":e[4]||(e[4]=t=>o.value.version=t),type:"textarea",placeholder:"请填写版本"},null,8,["modelValue"])]),_:1}),a(u,{field:"remark",feedback:"",label:"备注"},{default:r(()=>[a(s,{modelValue:o.value.remark,"onUpdate:modelValue":e[5]||(e[5]=t=>o.value.remark=t),type:"textarea",placeholder:"请填写备注"},null,8,["modelValue"])]),_:1}),a(u,null,{default:r(()=>[d("div",T,[a(N,{onClick:x},{default:r(()=>e[8]||(e[8]=[b("返回")])),_:1}),a(N,{type:"primary",onClick:q},{default:r(()=>e[9]||(e[9]=[b("提交")])),_:1})])]),_:1})]),_:1},8,["model"])])])}}},ae=O(Q,[["__scopeId","data-v-c8b0feed"]]);export{ae as default};
