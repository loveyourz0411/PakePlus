var m=Object.defineProperty;var x=(d,e,s)=>e in d?m(d,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):d[e]=s;var o=(d,e,s)=>x(d,typeof e!="symbol"?e+"":e,s);import{r as h,o as T,f as v,g,i as B}from"./index-Dju9e0Mk.js";const a=class a{constructor(e,s,t){this.placeholder=e,this.type=s,this.settings=this.simpleMerge(a.DEFAULT_OPTIONS,t),this.createInstrument()}createInstrument(){const e=this.settings.imagesDirectory;switch(this.type){case a.TYPE_HEADING:this.createHeadingIndicator(e);break;case a.TYPE_AIRSPEED:this.createAirspeedIndicator(e);break;case a.TYPE_ALTIMETER:this.createAltimeterIndicator(e);break;case a.TYPE_VERTICAL_SPEED:this.createVerticalSpeedIndicator(e);break;case a.TYPE_ATTITUDE:this.createAttitudeIndicator(e);break;case a.TYPE_TURN_COORDINATOR:this.createCoordinatorIndicator(e);break;default:return null}this.resize(this.settings.size),this.toggleBox(this.settings.hideBox)}updateHeading(e){const s=this.placeholder.querySelector("div.instrument.heading div.heading");s.style.transform=`rotate(${-e}deg)`}updateRoll(e){const s=this.placeholder.querySelector("div.instrument.attitude div.roll");s.style.transform=`rotate(${e}deg)`}updatePitch(e){e>a.CONSTANTS.pitch_bound?e=a.CONSTANTS.pitch_bound:e<-a.CONSTANTS.pitch_bound&&(e=-a.CONSTANTS.pitch_bound);const s=this.placeholder.querySelector("div.instrument.attitude div.roll div.pitch");s.style.top=`${e*.7}%`}updateCoordinator(e){const s=this.placeholder.querySelector("div.instrument.turn-coordinator div.turn");s.style.transform=`rotate(${e}deg)`}updateVerticalSpeed(e){e>a.CONSTANTS.vertical_speed_bound?e=a.CONSTANTS.vertical_speed_bound:e<-a.CONSTANTS.vertical_speed_bound&&(e=-a.CONSTANTS.vertical_speed_bound),e=e*90;const s=this.placeholder.querySelector("div.instrument.vertical-speed div.vertical-speed");s.style.transform=`rotate(${e}deg)`}updateAirSpeed(e){e>a.CONSTANTS.airspeed_bound_h?e=a.CONSTANTS.airspeed_bound_h:e<a.CONSTANTS.airspeed_bound_l&&(e=a.CONSTANTS.airspeed_bound_l),e=90+e*2;const s=this.placeholder.querySelector("div.instrument.airspeed div.speed");s.style.transform=`rotate(${e}deg)`}updateAltitude(e){const s=90+e%1e3*360/1e3,t=e/1e4*360,i=this.placeholder.querySelector("div.instrument.altimeter div.needle");i.style.transform=`rotate(${s}deg)`;const n=this.placeholder.querySelector("div.instrument.altimeter div.small-needle");n.style.transform=`rotate(${t}deg)`}updatePressure(e){e=2*e-1980;const s=this.placeholder.querySelector("div.instrument.altimeter div.pressure");s.style.transform=`rotate(${e}deg)`}resize(e){const s=this.placeholder.querySelector("div.instrument");s.style.height=`${e}px`,s.style.width=`${e}px`}toggleBox(e){this.placeholder.querySelector("img.box.background").classList.toggle("hidden",e)}showBox(){this.placeholder.querySelector("img.box.background").classList.remove("hidden")}hideBox(){this.placeholder.querySelector("img.box.background").classList.add("hidden")}simpleMerge(...e){return e.reduce((s,t)=>({...s,...t}),{})}mergeOptions(...e){const s={};let t=!1,i=0;const n=e.length;for((c=>typeof c=="boolean")(e[0])&&(t=e[0],i++);i<n;i++){const c=e[i];this.mergeObject(s,c,t)}return s}mergeObject(e,s,t){for(const i in s)s.hasOwnProperty(i)&&(t&&(r=>(r==null?void 0:r.constructor)===Object)(s[i])?e[i]=this.mergeOptions(!0,e[i],s[i]):e[i]=s[i])}toggle(e){this.placeholder.classList.toggle("hidden",e)}show(){this.placeholder.classList.remove("hidden")}hide(){this.placeholder.classList.add("hidden")}createDivIndicator(e){const s=document.createElement("div");return s.setAttribute("class",`instrument ${e}`),s}createFiBoxImage(e){const s=this.createImgBox(e,"fi_box.svg");return s.classList.add("background"),s}createDivBox(e,s,t){const i=document.createElement("div");i.setAttribute("class",`${e} box`);const n=this.createImgBox(s,t);return i.appendChild(n),i}createImgBox(e,s){const t=document.createElement("img");return t.setAttribute("class","box"),t.src=`${e}/${s}`,t}createNeedleBox(e,s){return this.createDivBox(e,s,"fi_needle.svg")}createRollBox(e){const t=this.createDivBox("roll",e,"horizon_back.svg"),i=this.createDivBox("pitch",e,"horizon_ball.svg"),n=this.createImgBox(e,"horizon_circle.svg");return t.appendChild(i),t.appendChild(n),t}createMechanicsBox(e,s=null){const i=this.createDivBox("mechanics",e,"fi_circle.svg");return s&&i.prepend(s),i}createHeadingIndicator(e){const t=this.createDivIndicator("heading"),i=this.createFiBoxImage(e),n=this.createDivBox("heading",e,"heading_yaw.svg"),r=this.createImgBox(e,"heading_mechanics.svg"),c=this.createMechanicsBox(e,r);return t.appendChild(i),t.appendChild(n),t.appendChild(c),this.placeholder.appendChild(t),this.updateHeading(this.settings.heading),t}createAltimeterIndicator(e){const t=this.createDivIndicator("altimeter"),i=this.createFiBoxImage(e),n=this.createDivBox("pressure",e,"altitude_pressure.svg"),r=this.createImgBox(e,"altitude_ticks.svg"),c=this.createDivBox("small-needle",e,"fi_needle_small.svg"),p=this.createNeedleBox("needle",e),u=this.createMechanicsBox(e);return t.appendChild(i),t.appendChild(n),t.appendChild(r),t.appendChild(c),t.appendChild(p),t.appendChild(u),this.placeholder.appendChild(t),this.updateAltitude(this.settings.altitude),this.updatePressure(this.settings.pressure),t}createAirspeedIndicator(e){const t=this.createDivIndicator("airspeed"),i=this.createFiBoxImage(e),n=this.createImgBox(e,"speed_mechanics.svg"),r=this.createNeedleBox("speed",e),c=this.createMechanicsBox(e);return t.appendChild(i),t.appendChild(n),t.appendChild(r),t.appendChild(c),this.placeholder.appendChild(t),this.updateAirSpeed(this.settings.airspeed),t}createAttitudeIndicator(e){const t=this.createDivIndicator("attitude"),i=this.createFiBoxImage(e),n=this.createRollBox(e),r=this.createImgBox(e,"horizon_mechanics.svg"),c=this.createMechanicsBox(e,r);return t.appendChild(i),t.appendChild(n),t.appendChild(c),this.placeholder.appendChild(t),this.updateRoll(this.settings.roll),this.updatePitch(this.settings.pitch),t}createCoordinatorIndicator(e){const t=this.createDivIndicator("turn-coordinator"),i=this.createFiBoxImage(e),n=this.createImgBox(e,"turn_coordinator.svg"),r=this.createDivBox("turn",e,"fi_tc_airplane.svg"),c=this.createMechanicsBox(e);return t.appendChild(i),t.appendChild(n),t.appendChild(r),t.appendChild(c),this.placeholder.appendChild(t),this.updateCoordinator(this.settings.turn),t}createVerticalSpeedIndicator(e){const t=this.createDivIndicator("vertical-speed"),i=this.createFiBoxImage(e),n=this.createImgBox(e,"vertical_mechanics.svg"),r=this.createNeedleBox("vertical-speed",e),c=this.createMechanicsBox(e);return t.appendChild(i),t.appendChild(n),t.appendChild(r),t.appendChild(c),this.placeholder.appendChild(t),this.updateVerticalSpeed(this.settings.verticalSpeed),t}};o(a,"TAG","instrument"),o(a,"TYPE_HEADING","heading"),o(a,"TYPE_AIRSPEED","airspeed"),o(a,"TYPE_ALTIMETER","altimeter"),o(a,"TYPE_VERTICAL_SPEED","vertical"),o(a,"TYPE_ATTITUDE","attitude"),o(a,"TYPE_TURN_COORDINATOR","coordinator"),o(a,"TYPES",[a.TYPE_HEADING,a.TYPE_AIRSPEED,a.TYPE_ALTIMETER,a.TYPE_VERTICAL_SPEED,a.TYPE_ATTITUDE,a.TYPE_TURN_COORDINATOR]),o(a,"CONSTANTS",{pitch_bound:30,vertical_speed_bound:1.95,airspeed_bound_l:0,airspeed_bound_h:160}),o(a,"DEFAULT_OPTIONS",{size:200,roll:0,pitch:0,turn:0,heading:0,verticalSpeed:0,airspeed:0,altitude:0,pressure:1e3,hideBox:!0,imagesDirectory:new URL("@/assets/flight",import.meta.url).href});let l=a;const S={__name:"index",props:{type:String,data:{type:Object,default:()=>({})}},setup(d,{expose:e}){const s=d,t=h(),i=h();let n=null;return T(()=>{const r=s.type||"TYPE_AIRSPEED";n=new l(t.value,l[r]),new ResizeObserver(()=>{n==null||n.resize(Math.min(i.value.clientWidth,i.value.clientHeight))}).observe(i.value)}),setInterval(()=>{n.updateAirSpeed(Math.random()*100)},1e3),e({updateValue:r=>{n==null||n.updateAirSpeed(r)}}),(r,c)=>(g(),v("div",{ref_key:"contentBox",ref:i,style:{width:"100%",height:"100%"}},[B("div",{ref_key:"flightIndicatorsRef",ref:t},null,512)],512))}};export{S as default};
